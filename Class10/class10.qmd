---
title: "class10 Structural Bioinformatics pt1."
author: "Solomon Kim "
format: pdf
---

#What is in the PDB Databasee 

The main repository of biomolecular structure infor is the PDB < www.rcsb.org >. 

Let's se what this database has

```{r}
stats <- read.csv("pdb_stats.csv", row.names = 1)
stats

```

>Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy.


We go to get rid of the commas. Can you find a function to get rid of the commas?

```{r}
x <- stats$X.ray
sum(as.numeric(sub(",", "", x)))
```

I am going to turn this into a function and then use `apply()` to work on the entire table of data


```{r}
sumcomma <- function(x) {
  sum(as.numeric(sub(",", "", x)))
}

```

```{r}
apply(stats, 2, sumcomma)/ sumcomma(stats$Total)
```
```{r}
n.total <- sumcomma(stats$Total)
n.total
```


```{r}
as.numeric( c(10, "1000"))
apply(stats, 2, sumcomma)
```


```{r}
apply(stats, 2, sumcomma)/sumcomma(stats$Total)
```
>Q2: What proportion of structures in the PDB are protein?


In Uniprot there are 248,805,733  entreies whcih cmopared to PDB protein entries (186,898) means there are only around 7% of known sequences with a known strucutre. 

```{r}
186898/248805733 *100
```



## Visualizing the HIV-1 protease structure

Mol* ("mole-star") viewer is now everywhere
https://molstar.org/viewer/

I want to insert my image from Mol* here

![My first molecular model](1HSG.png)



![Space Fill Representation](2HSG.png)


## Working with the Bio3D package


```{r}
library(bio3d)
```

```{r}
pdb <- read.pdb("1hsg")
pdb
```
 

```{r}
head(pdb$atom)
```

```{r}
pdbseq(pdb)[25]
```

## Predicting functional motions of a single structure  

We can do a bioinformatics prediction of functional motions (i.e. flexibility/dynamics):

```{r}
pdb <- read.pdb("6s36")
pdb
```

```{r}
m<- nma(pdb)
plot(m)
```


```{r}
mktrj(m, file="adk_m7.pdb")

```

